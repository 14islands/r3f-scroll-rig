import t from"zustand";import n,{useLayoutEffect as r,useEffect as o,forwardRef as e,useRef as i,useImperativeHandle as l,useCallback as c,useMemo as u,useState as a}from"react";import{addEffect as s,invalidate as d}from"@react-three/fiber";import f from"debounce";import v from"@studio-freight/lenis";import{useInView as h}from"react-intersection-observer";import p from"vecn";function w(){return w=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},w.apply(this,arguments)}function g(t,n){if(null==t)return{};var r,o,e={},i=Object.keys(t);for(o=0;o<i.length;o++)n.indexOf(r=i[o])>=0||(e[r]=t[r]);return e}function m(t){var n=function(t,n){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof n?n:String(n)}var b=t(function(t){return{debug:!1,scaleMultiplier:1,globalRender:!0,globalPriority:1e3,globalAutoClear:!1,globalClearDepth:!0,globalRenderQueue:!1,clearGlobalRenderQueue:function(){return t(function(){return{globalRenderQueue:!1}})},isCanvasAvailable:!0,hasSmoothScrollbar:!1,canvasChildren:{},renderToCanvas:function(n,r,o){return void 0===o&&(o={}),t(function(t){var e,i=t.canvasChildren;return Object.getOwnPropertyDescriptor(i,n)?(i[n].instances+=1,i[n].props.inactive=!1,{canvasChildren:i}):{canvasChildren:w({},i,((e={})[n]={mesh:r,props:o,instances:1},e))}})},updateCanvas:function(n,r){return t(function(t){var o,e=t.canvasChildren;if(e[n]){var i=e[n],l=i.instances;return{canvasChildren:w({},e,((o={})[n]={mesh:i.mesh,props:w({},i.props,r),instances:l},o))}}})},removeFromCanvas:function(n,r){return void 0===r&&(r=!0),t(function(t){var o,e=t.canvasChildren;return(null==(o=e[n])?void 0:o.instances)>1?(e[n].instances-=1,{canvasChildren:e}):r?{canvasChildren:g(e,[n].map(m))}:(e[n].instances=0,e[n].props.inactive=!0,{canvasChildren:w({},e)})})},pageReflow:0,requestReflow:function(){t(function(t){return{pageReflow:t.pageReflow+1}})},scroll:{y:0,x:0,limit:0,velocity:0,progress:0,direction:0,scrollDirection:void 0},scrollTo:function(t){return window.scrollTo(0,t)},onScroll:function(){return function(){}}}}),y=function(){return{enabled:b(function(t){return t.hasSmoothScrollbar}),scroll:b(function(t){return t.scroll}),scrollTo:b(function(t){return t.scrollTo}),onScroll:b(function(t){return t.onScroll})}},S="undefined"!=typeof window?r:o,C=["children","duration","easing","smooth","direction","config"],R=function(t){return 1===t?1:1-Math.pow(2,-10*t)},E=e(function(t,n){var r=t.children,e=t.duration,c=void 0===e?1:e,u=t.easing,a=void 0===u?R:u,s=t.smooth,d=void 0===s||s,f=t.direction,h=void 0===f?"vertical":f,p=t.config,m=g(t,C),b=i();return l(n,function(){return b.current}),o(function(){var t=b.current=new v(w({duration:c,easing:a,smooth:d,direction:h},p));return function(){t.destroy()}},[c,a,d,h]),r&&r(m)}),x=e(function(t,r){var e=t.children,a=t.enabled,v=void 0===a||a,h=t.locked,p=void 0!==h&&h,g=t.scrollRestoration,m=void 0===g?"auto":g,y=t.disablePointerOnScroll,C=void 0===y||y,R=t.horizontal,x=void 0!==R&&R,L=t.scrollInContainer,T=void 0!==L&&L,O=t.updateGlobalState,j=void 0===O||O,V=t.onScroll,z=t.config,I=i(),U=i(),M=i(!1),P=b(function(t){return t.scroll});l(r,function(){return{scrollTo:function(t,n){var r;return null==(r=U.current)?void 0:r.scrollTo(t,n)},__lenis:U.current}});var D=function(t){C&&I.current&&M.current!==t&&(M.current=t,I.current.style.pointerEvents=t?"none":"auto")},B=c(function(){D(!1)},[]),H=c(function(t){var n;return null==(n=U.current)||n.on("scroll",t),function(){var n;return null==(n=U.current)?void 0:n.off("scroll",t)}},[]);S(function(){"scrollRestoration"in window.history&&(window.history.scrollRestoration=m)},[]),o(function(){var t,n,r,o=s(function(t){var n;return null==(n=U.current)?void 0:n.raf(t)});null==(t=U.current)||t.on("scroll",function(t){var n=t.scroll,r=t.limit,o=t.velocity,e=t.direction,i=t.progress;j&&(P.y=x?0:n,P.x=x?n:0,P.limit=r,P.velocity=o,P.direction=e,P.progress=i);var l=f.debounce(function(){return D(!0)},100,!0);Math.abs(o)>1.4?l():D(!1),V&&V({scroll:n,limit:r,velocity:o,direction:e,progress:i}),d()}),null==(n=U.current)||n.notify(),j&&(P.scrollDirection=x?"horizontal":"vertical",b.setState({scrollTo:null==(r=U.current)?void 0:r.scrollTo}),b.setState({onScroll:H}),b.getState().scroll.y=window.scrollY,b.getState().scroll.x=window.scrollX),document.documentElement.classList.toggle("js-smooth-scrollbar-enabled",v),document.documentElement.classList.toggle("js-smooth-scrollbar-disabled",!v),b.setState({hasSmoothScrollbar:v});var e=function(){return d()};return window.addEventListener("pointermove",B),window.addEventListener("wheel",e),function(){o(),window.removeEventListener("pointermove",B),window.removeEventListener("wheel",e)}},[v]),o(function(){var t,n;p?null==(t=U.current)||t.stop():null==(n=U.current)||n.start()},[p]);var W=u(function(){if("undefined"==typeof document)return{};var t=document.documentElement,n=document.body,r=document.body.firstElementChild;return t.classList.toggle("ScrollRig-scrollHtml",T),n.classList.toggle("ScrollRig-scrollWrapper",T),{wrapper:n,content:r}},[T]);return n.createElement(E,{ref:U,smooth:v,direction:x?"horizontal":"vertical",config:w(T?{smoothTouch:!0,wrapper:W.wrapper,content:W.content}:{},z)},function(t){return e(w({},t,{ref:I}))})}),L="undefined"!=typeof window;function T(t,n,r,o,e){return o+(t-n)*(e-o)/(r-n)}function O(t,n){var r=function(t){var n={}.debounce,r=void 0===n?0:n,e=a({width:L?window.innerWidth:Infinity,height:L?window.innerHeight:Infinity}),i=e[0],l=e[1];return o(function(){var t=document.getElementById("ScrollRig-canvas");function n(){var n=t?t.clientWidth:window.innerWidth,r=t?t.clientHeight:window.innerHeight;n===i.width&&r===i.height||l({width:n,height:r})}var o,e=f.debounce(n,r);return t?(o=new ResizeObserver(e)).observe(t):window.addEventListener("resize",e),n(),function(){var t;window.removeEventListener("resize",e),null==(t=o)||t.disconnect()}},[]),i}(),e=y(),l=e.scroll,s=e.onScroll,d=b(function(t){return t.scaleMultiplier}),v=b(function(t){return t.pageReflow}),g=u(function(){var t={rootMargin:"0%",threshold:0,autoUpdate:!0},r=n||{};return Object.keys(r).map(function(n,o){void 0!==r[n]&&(t[n]=r[n])}),t},[n]),m=g.autoUpdate,C=g.wrapper,R=h({rootMargin:g.rootMargin,threshold:g.threshold}),E=R.ref,x=R.inView;S(function(){E(t.current)},[t]);var O=a(),j=O[0],V=O[1],z=i({inViewport:!1,progress:-1,visibility:-1,viewport:-1}).current,I=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0}).current,U=a(I),M=U[0],P=U[1],D=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0,positiveYUpBottom:0}).current,B=i(p.vec3(0,0,0)).current;S(function(){var n,r=null==(n=t.current)?void 0:n.getBoundingClientRect();if(r){var o=C?C.scrollTop:window.scrollY,e=C?C.scrollLeft:window.scrollX;I.top=r.top+o,I.bottom=r.bottom+o,I.left=r.left+e,I.right=r.right+e,I.width=r.width,I.height=r.height,I.x=I.left+.5*r.width,I.y=I.top+.5*r.height,P(w({},I)),V(p.vec3((null==I?void 0:I.width)*d,(null==I?void 0:I.height)*d,1))}},[t,r,v,d]);var H=c(function(n){var o=void 0===n?{}:n,e=o.onlyUpdateInViewport,i=o.scroll,c=void 0===i?l:i;if(t.current&&(void 0!==e&&!e||z.inViewport)){!function(t,n,r,o){t.top=n.top-r.y,t.bottom=n.bottom-r.y,t.left=n.left-r.x,t.right=n.right-r.x,t.width=n.width,t.height=n.height,t.x=t.left+.5*n.width-.5*o.width,t.y=t.top+.5*n.height-.5*o.height,t.positiveYUpBottom=o.height-t.bottom}(D,I,c,r),function(t,n,r){t.x=n.x*r,t.y=-1*n.y*r}(B,D,d);var u="horizontal"===c.scrollDirection,a=u?"width":"height",s=r[a]-D[u?"left":"top"];z.progress=T(s,0,r[a]+D[a],0,1),z.visibility=T(s,0,D[a],0,1),z.viewport=T(s,0,r[a],0,1)}},[t,r,d,l]);return S(function(){z.inViewport=x,H({onlyUpdateInViewport:!1})},[x]),S(function(){H({onlyUpdateInViewport:!1})},[H]),o(function(){if(m)return s(function(t){return H()})},[m,H,s]),{rect:M,bounds:D,scale:j,position:B,scrollState:z,inViewport:x,update:function(t){return H(w({onlyUpdateInViewport:!1},t))}}}export{x as SmoothScrollbar,y as useScrollbar,O as useTracker};
//# sourceMappingURL=scrollbar.module.js.map
