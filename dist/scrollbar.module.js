import n from"zustand";import t,{useLayoutEffect as r,useEffect as o,forwardRef as e,useRef as i,useImperativeHandle as l,useCallback as c,useMemo as u,useState as a}from"react";import{addEffect as s,invalidate as d}from"@react-three/fiber";import f from"debounce";import v from"@studio-freight/lenis";import{useInView as h}from"react-intersection-observer";import p from"vecn";function w(){return w=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},w.apply(this,arguments)}function g(n,t){if(null==n)return{};var r,o,e={},i=Object.keys(n);for(o=0;o<i.length;o++)t.indexOf(r=i[o])>=0||(e[r]=n[r]);return e}function m(n){var t=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==typeof t?t:String(t)}var b=n(function(n){return{debug:!1,scaleMultiplier:1,globalRender:!0,globalPriority:1e3,globalAutoClear:!1,globalClearDepth:!0,globalRenderQueue:!1,clearGlobalRenderQueue:function(){return n(function(){return{globalRenderQueue:!1}})},isCanvasAvailable:!0,hasSmoothScrollbar:!1,canvasChildren:{},renderToCanvas:function(t,r,o){return void 0===o&&(o={}),n(function(n){var e,i=n.canvasChildren;return Object.getOwnPropertyDescriptor(i,t)?(i[t].instances+=1,i[t].props.inactive=!1,{canvasChildren:i}):{canvasChildren:w({},i,((e={})[t]={mesh:r,props:o,instances:1},e))}})},updateCanvas:function(t,r){return n(function(n){var o,e=n.canvasChildren;if(e[t]){var i=e[t],l=i.instances;return{canvasChildren:w({},e,((o={})[t]={mesh:i.mesh,props:w({},i.props,r),instances:l},o))}}})},removeFromCanvas:function(t,r){return void 0===r&&(r=!0),n(function(n){var o,e=n.canvasChildren;return(null==(o=e[t])?void 0:o.instances)>1?(e[t].instances-=1,{canvasChildren:e}):r?{canvasChildren:g(e,[t].map(m))}:(e[t].instances=0,e[t].props.inactive=!0,{canvasChildren:w({},e)})})},pageReflow:0,requestReflow:function(){n(function(n){return{pageReflow:n.pageReflow+1}})},scroll:{y:0,x:0,limit:0,velocity:0,progress:0,direction:""},scrollTo:function(n){return window.scrollTo(0,n)},onScroll:function(){return function(){}}}}),y=function(){return{enabled:b(function(n){return n.hasSmoothScrollbar}),scroll:b(function(n){return n.scroll}),scrollTo:b(function(n){return n.scrollTo}),onScroll:b(function(n){return n.onScroll})}},S="undefined"!=typeof window?r:o,C=["children","duration","easing","smooth","direction","config"],R=function(n){return 1===n?1:1-Math.pow(2,-10*n)},E=e(function(n,t){var r=n.children,e=n.duration,c=void 0===e?1:e,u=n.easing,a=void 0===u?R:u,s=n.smooth,d=void 0===s||s,f=n.direction,h=void 0===f?"vertical":f,p=n.config,m=g(n,C),b=i();return l(t,function(){return{start:function(){var n;return null==(n=b.current)?void 0:n.start()},stop:function(){var n;return null==(n=b.current)?void 0:n.stop()},on:function(n,t){var r;return null==(r=b.current)?void 0:r.on(n,t)},once:function(n,t){var r;return null==(r=b.current)?void 0:r.once(n,t)},off:function(n,t){var r;return null==(r=b.current)?void 0:r.off(n,t)},notify:function(){var n;return null==(n=b.current)?void 0:n.notify()},scrollTo:function(n,t){var r;return null==(r=b.current)?void 0:r.scrollTo(n,t)},raf:function(n){var t;return null==(t=b.current)?void 0:t.raf(n)}}}),o(function(){var n=b.current=new v(w({duration:c,easing:a,smooth:d,direction:h},p));return function(){n.destroy()}},[c,a,d,h]),r&&r(m)}),x=function(n){var r=n.children,e=n.enabled,l=void 0===e||e,a=n.locked,v=void 0!==a&&a,h=n.scrollRestoration,p=void 0===h?"auto":h,g=n.disablePointerOnScroll,m=void 0===g||g,y=n.horizontal,C=void 0!==y&&y,R=n.scrollInContainer,x=void 0!==R&&R,L=n.updateGlobalState,T=void 0===L||L,O=n.onScroll,j=n.config,V=i(),z=i(),I=i(!1),U=b(function(n){return n.scroll}),M=function(n){m&&V.current&&I.current!==n&&(I.current=n,V.current.style.pointerEvents=n?"none":"auto")},P=c(function(){M(!1)},[]),B=c(function(n){var t;return null==(t=z.current)||t.on("scroll",n),function(){var t;return null==(t=z.current)?void 0:t.off("scroll",n)}},[]);S(function(){"scrollRestoration"in window.history&&(window.history.scrollRestoration=p)},[]),o(function(){var n,t,r,o=s(function(n){var t;return null==(t=z.current)?void 0:t.raf(n)});null==(n=z.current)||n.on("scroll",function(n){var t=n.scroll,r=n.limit,o=n.velocity,e=n.direction,i=n.progress;T&&(U.y="vertical"===e?t:0,U.x="horizontal"===e?t:0,U.limit=r,U.velocity=o,U.direction=e,U.progress=i);var l=f.debounce(function(){return M(!0)},100,!0);Math.abs(o)>1.4?l():M(!1),O&&O({scroll:t,limit:r,velocity:o,direction:e,progress:i}),d()}),null==(t=z.current)||t.notify(),T&&(b.setState({scrollTo:null==(r=z.current)?void 0:r.scrollTo}),b.setState({onScroll:B}),b.getState().scroll.y=window.scrollY,b.getState().scroll.x=window.scrollX),document.documentElement.classList.toggle("js-smooth-scrollbar-enabled",l),document.documentElement.classList.toggle("js-smooth-scrollbar-disabled",!l),b.setState({hasSmoothScrollbar:l});var e=function(){return d()};return window.addEventListener("pointermove",P),window.addEventListener("wheel",e),function(){o(),window.removeEventListener("pointermove",P),window.removeEventListener("wheel",e)}},[l]),o(function(){var n,t;v?null==(n=z.current)||n.stop():null==(t=z.current)||t.start()},[v]);var H=u(function(){if("undefined"==typeof document)return{};var n=document.documentElement,t=document.body,r=document.body.firstElementChild;return n.classList.toggle("ScrollRig-scrollHtml",x),t.classList.toggle("ScrollRig-scrollWrapper",x),{wrapper:t,content:r}},[x]);return t.createElement(E,{ref:z,smooth:l,direction:C?"horizontal":"vertical",config:w(x?{smoothTouch:!0,wrapper:H.wrapper,content:H.content}:{},j)},function(n){return r(w({},n,{ref:V}))})},L="undefined"!=typeof window;function T(n,t,r,o,e){return o+(n-t)*(e-o)/(r-t)}function O(n,t){var r=function(){var n=a({width:L?window.innerWidth:Infinity,height:L?window.innerHeight:Infinity}),t=n[0],r=n[1];return o(function(){var n=document.getElementById("ScrollRig-canvas");function t(){r({width:n?n.clientWidth:window.innerWidth,height:n?n.clientHeight:window.innerHeight})}var o,e=f.debounce(t,200);return n?(o=new ResizeObserver(e)).observe(n):window.addEventListener("resize",e),t(),function(){var n;window.removeEventListener("resize",e),null==(n=o)||n.disconnect()}},[]),t}(),e=y(),l=e.scroll,u=e.onScroll,s=b(function(n){return n.scaleMultiplier}),d=b(function(n){return n.pageReflow}),v=w({},{rootMargin:"50%",threshold:0,autoUpdate:!0,wrapper:window},t),g=v.autoUpdate,m=v.wrapper,C=h({rootMargin:v.rootMargin,threshold:v.threshold}),R=C.ref,E=C.inView;S(function(){R(n.current)},[n]);var x=a(),O=x[0],j=x[1],V=i({inViewport:!1,progress:-1,visibility:-1,viewport:-1}).current,z=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0}).current,I=a(z),U=I[0],M=I[1],P=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0,positiveYUpBottom:0}).current,B=i(p.vec3(0,0,0)).current;S(function(){var t,r=null==(t=n.current)?void 0:t.getBoundingClientRect(),o=m===window?m.scrollY:m.scrollTop,e=m===window?m.scrollX:m.scrollLeft;z.top=r.top+o,z.bottom=r.bottom+o,z.left=r.left+e,z.right=r.right+e,z.width=r.width,z.height=r.height,z.x=z.left+.5*r.width,z.y=z.top+.5*r.height,M(w({},z)),j(p.vec3((null==z?void 0:z.width)*s,(null==z?void 0:z.height)*s,1))},[n,r,d,s]);var H=c(function(t){var o=void 0===t?{}:t,e=o.onlyUpdateInViewport,i=o.scroll,c=void 0===i?l:i;if(n.current&&(void 0!==e&&!e||V.inViewport)){!function(n,t,r,o){n.top=t.top-r.y,n.bottom=t.bottom-r.y,n.left=t.left-r.x,n.right=t.right-r.x,n.width=t.width,n.height=t.height,n.x=n.left+.5*t.width-.5*o.width,n.y=n.top+.5*t.height-.5*o.height,n.positiveYUpBottom=o.height-n.bottom}(P,z,c,r),function(n,t,r){n.x=t.x*r,n.y=-1*t.y*r}(B,P,s);var u="horizontal"===c.direction,a=u?"width":"height",d=r[a]-P[u?"left":"top"];V.progress=T(d,0,r[a]+P[a],0,1),V.visibility=T(d,0,P[a],0,1),V.viewport=T(d,0,r[a],0,1)}},[n,r,s,l]);return S(function(){V.inViewport=E,H({onlyUpdateInViewport:!1})},[E]),S(function(){H({onlyUpdateInViewport:!1})},[H]),o(function(){if(g)return u(function(n){return H()})},[g,H,u]),{rect:U,bounds:P,scale:O,position:B,scrollState:V,inViewport:E,update:function(n){return H(w({onlyUpdateInViewport:!1},n))}}}export{x as SmoothScrollbar,y as useScrollbar,O as useTracker};
//# sourceMappingURL=scrollbar.module.js.map
