import n from"zustand";import t,{useLayoutEffect as r,useEffect as o,forwardRef as e,useRef as i,useImperativeHandle as l,useCallback as c,useState as u}from"react";import{addEffect as a,invalidate as s}from"@react-three/fiber";import d from"debounce";import f from"@studio-freight/lenis";import{useInView as v}from"react-intersection-observer";import h from"vecn";function p(){return p=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},p.apply(this,arguments)}function w(n,t){if(null==n)return{};var r,o,e={},i=Object.keys(n);for(o=0;o<i.length;o++)t.indexOf(r=i[o])>=0||(e[r]=n[r]);return e}function g(n){var t=function(n,t){if("object"!=typeof n||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==typeof t?t:String(t)}var m=n(function(n){return{debug:!1,scaleMultiplier:1,globalRender:!0,globalPriority:1e3,globalAutoClear:!1,globalClearDepth:!0,globalRenderQueue:!1,clearGlobalRenderQueue:function(){return n(function(){return{globalRenderQueue:!1}})},isCanvasAvailable:!0,hasSmoothScrollbar:!1,canvasChildren:{},renderToCanvas:function(t,r,o){return void 0===o&&(o={}),n(function(n){var e,i=n.canvasChildren;return Object.getOwnPropertyDescriptor(i,t)?(i[t].instances+=1,i[t].props.inactive=!1,{canvasChildren:i}):{canvasChildren:p({},i,((e={})[t]={mesh:r,props:o,instances:1},e))}})},updateCanvas:function(t,r){return n(function(n){var o,e=n.canvasChildren;if(e[t]){var i=e[t],l=i.instances;return{canvasChildren:p({},e,((o={})[t]={mesh:i.mesh,props:p({},i.props,r),instances:l},o))}}})},removeFromCanvas:function(t,r){return void 0===r&&(r=!0),n(function(n){var o,e=n.canvasChildren;return(null==(o=e[t])?void 0:o.instances)>1?(e[t].instances-=1,{canvasChildren:e}):r?{canvasChildren:w(e,[t].map(g))}:(e[t].instances=0,e[t].props.inactive=!0,{canvasChildren:p({},e)})})},pageReflow:0,requestReflow:function(){n(function(n){return{pageReflow:n.pageReflow+1}})},scroll:{y:0,x:0,limit:0,velocity:0,progress:0,direction:""},scrollTo:function(n){return window.scrollTo(0,n)},onScroll:function(){return function(){}}}}),b=function(){return{enabled:m(function(n){return n.hasSmoothScrollbar}),scroll:m(function(n){return n.scroll}),scrollTo:m(function(n){return n.scrollTo}),onScroll:m(function(n){return n.onScroll})}},y="undefined"!=typeof window?r:o,S=["children","duration","easing","smooth","direction","config"],C=function(n){return 1===n?1:1-Math.pow(2,-10*n)},x=e(function(n,t){var r=n.children,e=n.duration,c=void 0===e?1:e,u=n.easing,a=void 0===u?C:u,s=n.smooth,d=void 0===s||s,v=n.direction,h=void 0===v?"vertical":v,g=n.config,m=w(n,S),b=i();return l(t,function(){return{start:function(){var n;return null==(n=b.current)?void 0:n.start()},stop:function(){var n;return null==(n=b.current)?void 0:n.stop()},on:function(n,t){var r;return null==(r=b.current)?void 0:r.on(n,t)},once:function(n,t){var r;return null==(r=b.current)?void 0:r.once(n,t)},off:function(n,t){var r;return null==(r=b.current)?void 0:r.off(n,t)},scrollTo:function(n,t){var r;return null==(r=b.current)?void 0:r.scrollTo(n,t)},raf:function(n){var t;return null==(t=b.current)?void 0:t.raf(n)}}}),o(function(){var n=b.current=new f(p({duration:c,easing:a,smooth:d,direction:h},g));return function(){n.destroy()}},[c,a,d,h]),r&&r(m)}),R=function(n){var r=n.children,e=n.enabled,l=void 0===e||e,u=n.locked,f=void 0!==u&&u,v=n.scrollRestoration,h=void 0===v?"auto":v,w=n.disablePointerOnScroll,g=void 0===w||w,b=n.horizontal,S=void 0!==b&&b,C=n.config,R=i(),E=i(),T=i(!1),j=m(function(n){return n.scroll});j.direction=S?"horizontal":"vertical";var L=function(n){g&&R.current&&T.current!==n&&(T.current=n,R.current.style.pointerEvents=n?"none":"auto")},O=c(function(){L(!1)},[]),V=c(function(n){var t;return null==(t=E.current)||t.on("scroll",n),function(){var t;return null==(t=E.current)?void 0:t.off("scroll",n)}},[]);return y(function(){"scrollRestoration"in window.history&&(window.history.scrollRestoration=h)},[]),o(function(){var n,t,r=a(function(n){var t;return null==(t=E.current)?void 0:t.raf(n)});null==(n=E.current)||n.on("scroll",function(n){var t=n.scroll,r=n.limit,o=n.velocity,e=n.direction,i=n.progress;j.y="vertical"===e?t:0,j.x="horizontal"===e?t:0,j.limit=r,j.velocity=o,j.direction=e,j.progress=i;var l=d.debounce(function(){return L(!0)},100,!0);Math.abs(o)>1.4?l():L(!1),s()}),m.setState({scrollTo:null==(t=E.current)?void 0:t.scrollTo}),m.setState({onScroll:V}),m.getState().scroll.y=window.scrollY,m.getState().scroll.x=window.scrollX,document.documentElement.classList.toggle("js-smooth-scrollbar-enabled",l),document.documentElement.classList.toggle("js-smooth-scrollbar-disabled",!l),m.setState({hasSmoothScrollbar:l});var o=function(){return s()};return window.addEventListener("pointermove",O),window.addEventListener("wheel",o),function(){r(),window.removeEventListener("pointermove",O),window.removeEventListener("wheel",o)}},[l]),o(function(){var n,t;f?null==(n=E.current)||n.stop():null==(t=E.current)||t.start()},[f]),t.createElement(x,{ref:E,smooth:l,direction:S?"horizontal":"vertical",config:C},function(n){return r(p({},n,{ref:R}))})},E="undefined"!=typeof window;function T(n,t,r,o,e){return o+(n-t)*(e-o)/(r-t)}var j={rootMargin:"50%",threshold:0,autoUpdate:!0};function L(n,t){var r=function(){var n=u({width:E?window.innerWidth:Infinity,height:E?window.innerHeight:Infinity}),t=n[0],r=n[1];return o(function(){function n(){r({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",n),n(),function(){return window.removeEventListener("resize",n)}},[]),t}(),e=b(),l=e.scroll,a=e.onScroll,s=m(function(n){return n.scaleMultiplier}),d=m(function(n){return n.pageReflow}),f=p({},j,t),w=f.autoUpdate,g=v({rootMargin:f.rootMargin,threshold:f.threshold}),S=g.ref,C=g.inView;y(function(){S(n.current)},[n]);var x=u(),R=x[0],L=x[1],O=i({inViewport:!1,progress:-1,visibility:-1,viewport:-1}).current,V=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0}).current,z=u(V),U=z[0],M=z[1],I=i({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0,positiveYUpBottom:0}).current,P=i(h.vec3(0,0,0)).current;y(function(){var t,r=null==(t=n.current)?void 0:t.getBoundingClientRect();V.top=r.top+window.scrollY,V.bottom=r.bottom+window.scrollY,V.left=r.left+window.scrollX,V.right=r.right+window.scrollX,V.width=r.width,V.height=r.height,V.x=V.left+.5*r.width,V.y=V.top+.5*r.height,M(p({},V)),L(h.vec3((null==V?void 0:V.width)*s,(null==V?void 0:V.height)*s,1))},[n,r,d,s]);var Y=c(function(t){var o=(void 0===t?{}:t).onlyUpdateInViewport;if(n.current&&(void 0!==o&&!o||O.inViewport)){!function(n,t,r,o){n.top=t.top-r.y,n.bottom=t.bottom-r.y,n.left=t.left-r.x,n.right=t.right-r.x,n.width=t.width,n.height=t.height,n.x=n.left+.5*t.width-.5*o.width,n.y=n.top+.5*t.height-.5*o.height,n.positiveYUpBottom=o.height-n.bottom}(I,V,l,r),function(n,t,r){n.x=t.x*r,n.y=-1*t.y*r}(P,I,s);var e="horizontal"===l.direction,i=e?"width":"height",c=r[i]-I[e?"left":"top"];O.progress=T(c,0,r[i]+I[i],0,1),O.visibility=T(c,0,I[i],0,1),O.viewport=T(c,0,r[i],0,1)}},[n,r,s,l]);return y(function(){O.inViewport=C,Y({onlyUpdateInViewport:!1})},[C]),y(function(){Y({onlyUpdateInViewport:!1})},[Y]),o(function(){if(w)return a(function(n){return Y()})},[w,Y,a]),{rect:U,bounds:I,scale:R,position:P,scrollState:O,inViewport:C,update:function(){return Y({onlyUpdateInViewport:!1})}}}export{R as SmoothScrollbar,b as useScrollbar,L as useTracker};
//# sourceMappingURL=scrollbar.module.js.map
