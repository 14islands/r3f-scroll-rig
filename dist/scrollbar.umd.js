!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("zustand"),require("react"),require("@studio-freight/lenis"),require("react-intersection-observer"),require("@juggle/resize-observer"),require("debounce"),require("vecn")):"function"==typeof define&&define.amd?define(["exports","zustand","react","@studio-freight/lenis","react-intersection-observer","@juggle/resize-observer","debounce","vecn"],t):t((e||self).r3FScrollRig={},e.zustand,e.React,e["@studio-freight/lenis"],e.reactIntersectionObserver,e["@juggle/resize-observer"],e.debounce,e.vecn)}(this,function(e,t,n,r,o,i,l,u){function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=/*#__PURE__*/c(t),s=/*#__PURE__*/c(r),d=/*#__PURE__*/c(l),f=/*#__PURE__*/c(u);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}function h(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var p=a.default(function(e){return{debug:!1,scaleMultiplier:1,globalRender:!0,globalPriority:1e3,globalClearDepth:!1,globalRenderQueue:!1,clearGlobalRenderQueue:function(){return e(function(){return{globalRenderQueue:!1}})},isCanvasAvailable:!0,hasSmoothScrollbar:!1,canvasChildren:{},renderToCanvas:function(t,n,r){return void 0===r&&(r={}),e(function(e){var o,i=e.canvasChildren;return Object.getOwnPropertyDescriptor(i,t)?(i[t].instances+=1,i[t].props.inactive=!1,{canvasChildren:i}):{canvasChildren:v({},i,((o={})[t]={mesh:n,props:r,instances:1},o))}})},updateCanvas:function(t,n){return e(function(e){var r,o=e.canvasChildren;if(o[t]){var i=o[t],l=i.instances;return{canvasChildren:v({},o,((r={})[t]={mesh:i.mesh,props:v({},i.props,n),instances:l},r))}}})},removeFromCanvas:function(t,n){return void 0===n&&(n=!0),e(function(e){var r,o=e.canvasChildren;return(null==(r=o[t])?void 0:r.instances)>1?(o[t].instances-=1,{canvasChildren:o}):n?{canvasChildren:function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(o,[t].map(h))}:(o[t].instances=0,o[t].props.inactive=!0,{canvasChildren:v({},o)})})},pageReflow:0,requestReflow:function(){e(function(e){return{pageReflow:e.pageReflow+1}})},scroll:{y:0,x:0,limit:0,velocity:0,progress:0,direction:0,scrollDirection:void 0},scrollTo:function(e){return window.scrollTo(0,e)},onScroll:function(){return function(){}}}}),w=function(){return{enabled:p(function(e){return e.hasSmoothScrollbar}),scroll:p(function(e){return e.scroll}),scrollTo:p(function(e){return e.scrollTo}),onScroll:p(function(e){return e.onScroll})}},g="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,m=n.forwardRef(function(e,t){var r=e.children,o=e.enabled,i=void 0===o||o,l=e.locked,u=void 0!==l&&l,c=e.scrollRestoration,a=void 0===c?"auto":c,d=e.disablePointerOnScroll,f=void 0===d||d,h=e.horizontal,w=void 0!==h&&h,m=e.scrollInContainer,b=void 0!==m&&m,y=e.updateGlobalState,S=void 0===y||y,R=e.onScroll,E=e.config,C=void 0===E?{}:E,T=e.invalidate,j=void 0===T?function(){}:T,z=e.addEffect,L=n.useRef(),O=n.useRef(),x=n.useRef(!1),I=p(function(e){return e.scroll});n.useImperativeHandle(t,function(){return{start:function(){var e;return null==(e=O.current)?void 0:e.start()},stop:function(){var e;return null==(e=O.current)?void 0:e.stop()},on:function(e,t){var n;return null==(n=O.current)?void 0:n.on(e,t)},notify:function(){var e;return null==(e=O.current)?void 0:e.emit()},emit:function(){var e;return null==(e=O.current)?void 0:e.emit()},scrollTo:function(e,t){var n;return null==(n=O.current)?void 0:n.scrollTo(e,t)},raf:function(e){var t;return null==(t=O.current)?void 0:t.raf(e)},__lenis:O.current}});var V=n.useCallback(function(e){f&&L.current&&x.current!==e&&(x.current=e,L.current.style.pointerEvents=e?"none":"auto")},[f,L,x]);return g(function(){"scrollRestoration"in window.history&&(window.history.scrollRestoration=a)},[]),g(function(){var e,t,n=document.documentElement,r=document.body,o=document.body.firstElementChild;return n.classList.toggle("ScrollRig-scrollHtml",b),r.classList.toggle("ScrollRig-scrollWrapper",b),b&&Object.assign(C,{smoothTouch:!0,wrapper:r,content:o}),O.current=new s.default(v({orientation:w?"horizontal":"vertical"},C)),z?e=z(function(e){var t;return null==(t=O.current)?void 0:t.raf(e)}):(t=requestAnimationFrame(function e(n){var r;null==(r=O.current)||r.raf(n),t=requestAnimationFrame(e)}),e=function(){return cancelAnimationFrame(t)}),function(){var t;e(),null==(t=O.current)||t.destroy()}},[]),g(function(){var e,t,n,r=function(e){var t=e.scroll,n=e.limit,r=e.velocity,o=e.direction,i=e.progress,l=w?t:0;S&&(I.y=w?0:t,I.x=l,I.limit=n,I.velocity=r,I.direction=o,I.progress=i),Math.abs(r)>1.5&&V(!0),Math.abs(r)<1&&V(!1),R&&R({scroll:t,limit:n,velocity:r,direction:o,progress:i}),j()};return null==(e=O.current)||e.on("scroll",r),S&&(I.scrollDirection=w?"horizontal":"vertical",p.setState({scrollTo:null==(n=O.current)?void 0:n.scrollTo}),p.setState({onScroll:function(e){var t,n;return null==(t=O.current)||t.on("scroll",e),null==(n=O.current)||n.emit(),function(){var t;return null==(t=O.current)?void 0:t.off("scroll",e)}}}),p.getState().scroll.y=window.scrollY,p.getState().scroll.x=window.scrollX),null==(t=O.current)||t.emit(),function(){var e;null==(e=O.current)||e.off("scroll",r)}},[]),g(function(){var e=function(){return j()},t=function(){return V(!1)};return window.addEventListener("pointermove",t),window.addEventListener("pointerdown",t),window.addEventListener("wheel",e),function(){window.removeEventListener("pointermove",t),window.removeEventListener("pointerdown",t),window.removeEventListener("wheel",e)}},[]),n.useEffect(function(){S&&(document.documentElement.classList.toggle("js-smooth-scrollbar-enabled",i),document.documentElement.classList.toggle("js-smooth-scrollbar-disabled",!i),p.setState({hasSmoothScrollbar:i}))},[i]),n.useEffect(function(){var e,t;u?null==(e=O.current)||e.stop():null==(t=O.current)||t.start()},[u]),r({ref:L})}),b="undefined"!=typeof window;function y(e,t,n,r,o){return r+(e-t)*(o-r)/(n-t)}e.SmoothScrollbar=m,e.useScrollbar=w,e.useTracker=function(e,t){var r=function(e){var t={}.debounce,r=void 0===t?0:t,o=n.useState({width:b?window.innerWidth:Infinity,height:b?window.innerHeight:Infinity}),l=o[0],u=o[1];return n.useEffect(function(){var e=document.getElementById("ScrollRig-canvas");function t(){var t=e?e.clientWidth:window.innerWidth,n=e?e.clientHeight:window.innerHeight;t===l.width&&n===l.height||u({width:t,height:n})}var n,o=d.default.debounce(t,r),c=window.ResizeObserver||i.ResizeObserver;return e?(n=new c(o)).observe(e):window.addEventListener("resize",o),t(),function(){var e;window.removeEventListener("resize",o),null==(e=n)||e.disconnect()}},[l,u]),l}(),l=w(),u=l.scroll,c=l.onScroll,a=p(function(e){return e.scaleMultiplier}),s=p(function(e){return e.pageReflow}),h=p(function(e){return e.debug}),m=n.useMemo(function(){var e={rootMargin:"0%",threshold:0,autoUpdate:!0},n=t||{};return Object.keys(n).map(function(t,r){void 0!==n[t]&&(e[t]=n[t])}),e},[t]),S=m.autoUpdate,R=m.wrapper,E=o.useInView({rootMargin:m.rootMargin,threshold:m.threshold}),C=E.ref,T=E.inView;g(function(){C(e.current)},[e]);var j=n.useState(f.default.vec3(0,0,0)),z=j[0],L=j[1],O=n.useRef({inViewport:!1,progress:-1,visibility:-1,viewport:-1}).current,x=n.useRef({top:0,bottom:0,left:0,right:0,width:0,height:0}).current,I=n.useState(x),V=I[0],q=I[1],k=n.useRef({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0,positiveYUpBottom:0}).current,M=n.useRef(f.default.vec3(0,0,0)).current;g(function(){var t,n=null==(t=e.current)?void 0:t.getBoundingClientRect();if(n){var o=R?R.scrollTop:window.scrollY,i=R?R.scrollLeft:window.scrollX;x.top=n.top+o,x.bottom=n.bottom+o,x.left=n.left+i,x.right=n.right+i,x.width=n.width,x.height=n.height,q(v({},x)),L(f.default.vec3((null==x?void 0:x.width)*a,(null==x?void 0:x.height)*a,1)),h&&console.log("useTracker.getBoundingClientRect:",x,"intialScroll:",{initialY:o,initialX:i},"size:",r,"pageReflow:",s)}},[e,r,s,a,h]);var U=n.useCallback(function(t){var n=void 0===t?{}:t,o=n.onlyUpdateInViewport;if(e.current&&(void 0===o||!o||O.inViewport)){var i=n.scroll||u;!function(e,t,n,r){e.top=t.top-(n.y||0),e.bottom=t.bottom-(n.y||0),e.left=t.left-(n.x||0),e.right=t.right-(n.x||0),e.width=t.width,e.height=t.height,e.x=e.left+.5*t.width-.5*r.width,e.y=e.top+.5*t.height-.5*r.height,e.positiveYUpBottom=r.height-e.bottom}(k,x,i,r),function(e,t,n){e.x=t.x*n,e.y=-1*t.y*n}(M,k,a);var l="horizontal"===i.scrollDirection,c=l?"width":"height",s=r[c]-k[l?"left":"top"];O.progress=y(s,0,r[c]+k[c],0,1),O.visibility=y(s,0,k[c],0,1),O.viewport=y(s,0,r[c],0,1)}},[e,r,a,u]);return g(function(){O.inViewport=T,U({onlyUpdateInViewport:!1}),h&&console.log("useTracker.inViewport:",T,"update()")},[T]),g(function(){U({onlyUpdateInViewport:!1}),h&&console.log("useTracker.update on resize/reflow")},[U,s]),n.useEffect(function(){if(S)return c(function(e){return U({onlyUpdateInViewport:!0})})},[S,U,c]),{rect:V,bounds:k,scale:z,position:M,scrollState:O,inViewport:T,update:U}}});
//# sourceMappingURL=scrollbar.umd.js.map
